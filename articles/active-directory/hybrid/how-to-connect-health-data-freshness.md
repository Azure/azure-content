---
title: Azure AD Connect Health - Health service data is not up to date alert | Microsoft Docs
description: This document describes the cause of "Health service data is not up to date" alert and how to troubleshoot it.
services: active-directory
documentationcenter: ''
author: zhiweiwangmsft
manager: SamuelD
editor: ''
ms.service: active-directory
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: conceptual
ms.date: 02/26/2018
ms.author: zhiweiw
ms.collection: M365-identity-device-management
---

# Health service data is not up to date alert

## Overview
The Agents on the on-premise machines that Azure AD Connect Health monitors periodically uploads data to Azure AD Connect Health Service. If the service does not receive data from an agent, the information presented in portal will be stale. To highlight the issue, the service will raise **Health service data is not up to date** alert. This is generated when the service has not received data in the last two hours.  

* The **Warning** status alert fires if the Health Service has received only **partial** data types sent from the server in the last two hours. Warning status alert does not trigger email notifications to the email notification recipients. 
* The **Error** status alert fires if the Health Service has not received any data types from the server in the last two hours. Error status alert triggers email notifications to configured recipients.

The Service gets the data from Agents that are running on the on-premise machines. Depending on the Service Type, the following tables lists the agents that run on the machine, what they do as well as the Data Types that is generated by the service. In some cases, there are multiple services involved in the process, so either of them could be the culprit. 

| Service Type | Agent (Windows Service name) | Purpose | Data Type generated  |
| --- | --- | --- | --- |  
| Azure AD Connect (Sync) | Azure AD Connect Health Sync Insights Service | Collect AAD Connect specific information (Connectors, Synchronization rules etc) | - AadSyncService-SynchronizationRules   - AadSyncService-Connectors  - AadSyncService-GlobalConfigurations   - AadSyncService-RunProfileResults  - AadSyncService-ServiceConfigurations  - AadSyncService-ServiceStatus   |
|  | Azure AD Connect Health Sync Monitoring Service | Collect (AAD Connect specific) Perf Counters, ETW Traces, Files | Performance Counter |
| AD DS | Azure AD Connect Health AD DS Insights Service | Perform Synthetic Tests, Collect Topology Information, Replication Metadata |  - Adds-TopologyInfo-Json  - Common-TestData-Json (Creates the test results)   | 
|  | Azure AD Connect Health AD DS Monitoring Service | Collect (ADDS specific) Perf Counters, ETW Traces, Files | - Performance Counter  - Common-TestData-Json (Uploads the test results)  |
| AD FS | Azure AD Connect Health AD FS Diagnostics Service | Perform Synthetic tests | TestResult (Creates the test results) | 
| | Azure AD Connect Health AD FS Insights Service  | Collect ADFS Usage Metrics | Adfs-UsageMetrics |
| | Azure AD Connect Health AD FS Monitoring Service | Collect (ADFS specific) Perf Counters, ETW Traces, Files | TestResult (Uploads the test results) | 

## Troubleshooting steps 

The steps required to diagnose the issue is given below. The first is a set of basic checks that are common to all Service Types. The table below that lists out specific steps for each Service Type and Data Type. 

> [!IMPORTANT] 
> This alert follows Connect Health [data retention policy](reference-connect-health-user-privacy.md#data-retention-policy)

Common Diagnostic Steps
* Make sure the latest versions of the agents are installed. View [release history](reference-connect-health-version-history.md). 
* Make sure that Azure AD Connect Health Agents services are **running** on the machine. For example, Connect Health for AD FS should have three services.  
  ![Verify Azure AD Connect Health](./media/how-to-connect-health-agent-install/install5.png)

* Make sure to go over and meet the [requirements section](how-to-connect-health-agent-install.md#requirements).
* Use [test connectivity tool](how-to-connect-health-agent-install.md#test-connectivity-to-azure-ad-connect-health-service) to discover connectivity issues.
* If you have an HTTP Proxy, follow these [configuration steps](how-to-connect-health-agent-install.md#configure-azure-ad-connect-health-agents-to-use-http-proxy). 

The alert detail blade lists out missing data element(s) from a server. The following table will help narrow down the problem further. 
### Connect Health for Sync
| Data elements | Troubleshooting steps |
| --- | --- | 
| PerfCounter | - [Outbound connectivity to the Azure service endpoint](https://docs.microsoft.com/azure/load-balancer/load-balancer-outbound-connections) <br />- [SSL Inspection for outbound traffic is filtered or disabled](https://technet.microsoft.com/library/ee796230.aspx) <br /> - [Firewall ports on the server running the agent](https://technet.microsoft.com/library/ms345310(v=sql.100).aspx) |
| AadSyncService-SynchronizationRules, <br /> AadSyncService-Connectors, <br /> AadSyncService-GlobalConfigurations, <br /> AadSyncService-RunProfileResults, <br /> AadSyncService-ServiceConfigurations, <br /> AadSyncService-ServiceStatus | - [Outbound connectivity to the Azure service endpoint](https://docs.microsoft.com/azure/load-balancer/load-balancer-outbound-connections) <br /> -  [Firewall ports on the server running the agent](https://technet.microsoft.com/library/ms345310(v=sql.100).aspx) | 

### Connect Health for ADFS

Extra steps to validate for AD FS and follow the workflow in [AD FS Help](https://adfshelp.microsoft.com/TroubleshootingGuides/Workflow/3ef51c1f-499e-4e07-b3c4-60271640e282).

| Data elements | Troubleshooting steps |
| --- | --- | 
| PerfCounter, TestResult | - [Outbound connectivity to the Azure service endpoint](https://docs.microsoft.com/azure/load-balancer/load-balancer-outbound-connections) <br />- [SSL Inspection for outbound traffic is filtered or disabled](https://technet.microsoft.com/library/ee796230.aspx) <br />-  [Firewall ports on the server running the agent](https://technet.microsoft.com/library/ms345310(v=sql.100).aspx) |
|  Adfs-UsageMetrics | Outbound connectivity based on IP Addresses, refer to [Azure IP Ranges](https://www.microsoft.com/download/details.aspx?id=41653) | 

### Connect Health for ADDS

| Data elements | Troubleshooting steps |
| --- | --- | 
| PerfCounter, Adds-TopologyInfo-Json, Common-TestData-Json | - [Outbound connectivity to the Azure service endpoint](https://docs.microsoft.com/azure/load-balancer/load-balancer-outbound-connections) <br /> -  [Firewall ports on the server running the agent](https://technet.microsoft.com/library/ms345310(v=sql.100).aspx) |


## Next steps
* [Azure AD Connect Health FAQ](reference-connect-health-faq.md)
